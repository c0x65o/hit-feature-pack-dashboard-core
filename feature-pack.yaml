name: dashboard-core
title: Dashboards
description: "Dashboard core: runtime + dashboard definition storage/APIs"

schema:
  source: src/schema/dashboard-definitions.ts
  exports:
    - dashboardDefinitions
    - dashboardDefinitionShares
    - dashboardDefinitionsRelations
    - dashboardDefinitionSharesRelations
    - DashboardDefinition
    - DashboardDefinitionShare
    - InsertDashboardDefinition
    - InsertDashboardDefinitionShare

api:
  routes:
    - path: /api/dashboard-templates
      methods: [GET]
      handler: "@hit/feature-pack-dashboard-core/server/api/dashboard-templates"
      description: "List dashboard templates compiled by hit run into .hit/generated/dashboard-templates.json"
    - path: /api/dashboard-definitions
      methods: [GET, POST]
      handler: "@hit/feature-pack-dashboard-core/server/api/dashboard-definitions"
      description: "List dashboard definitions visible to the user (GET) or create a dashboard definition (POST)"
    - path: /api/dashboard-definitions/[key]
      methods: [GET, PUT]
      handler: "@hit/feature-pack-dashboard-core/server/api/dashboard-definitions-key"
      description: "Get a dashboard definition (GET) or update a user-owned definition (PUT)"
    - path: /api/dashboard-definitions/[key]/shares
      methods: [GET, POST, DELETE]
      handler: "@hit/feature-pack-dashboard-core/server/api/dashboard-definitions-shares"
      description: "List/add/remove share entries for a dashboard definition (ACL)"

routes:
  - path: /dashboards
    page: Dashboards
    roles: []
    default_roles_allow: [user]
    authz: { entity: dashboards, verb: read }

nav: []

# ─────────────────────────────────────────────────────────────────────────────
# PERMISSIONS - Action definitions (for admin-core permissions UI + runtime checks)
# ─────────────────────────────────────────────────────────────────────────────
permissions:
  actions:
    # Scope Policy Tree: dashboard-core (global) -> entity overrides.
    #
    # Scope modes:
    # - none: deny all access for this verb/entity (hide pages + block APIs)
    # - any: ignore scope (read everything, respecting visibility and shares)
    # - own: only owned dashboards (dashboard.owner_user_id === current user id)
    # - ldd: same as own (dashboards don't have LDD fields, so can't check LDD)
    #
    # These are mutually exclusive per node; the Security Groups UI renders them as dropdowns.
    - key: dashboard-core.read.scope.none
      label: "Dashboard Read Scope = None"
      description: "Deny all dashboard read access."
      default_enabled: false
    - key: dashboard-core.read.scope.any
      label: "Dashboard Read Scope = Any"
      description: "Read all dashboards regardless of ownership (respects visibility and shares)."
      default_enabled: false
    - key: dashboard-core.read.scope.own
      label: "Dashboard Read Scope = Own"
      description: "Read only dashboards you own."
      default_enabled: false

    - key: dashboard-core.write.scope.none
      label: "Dashboard Write Scope = None"
      description: "Deny all dashboard write access."
      default_enabled: false
    - key: dashboard-core.write.scope.any
      label: "Dashboard Write Scope = Any"
      description: "Edit all dashboards regardless of ownership (respects shares)."
      default_enabled: false
    - key: dashboard-core.write.scope.own
      label: "Dashboard Write Scope = Own"
      description: "Edit only dashboards you own."
      default_enabled: false

    # Dashboards override (optional): if set, overrides dashboard-core.read.scope.* for dashboards only.
    - key: dashboard-core.dashboards.read.scope.none
      label: "Dashboard Dashboards Read Scope = None"
      description: "Deny all dashboard read access."
      default_enabled: false
    - key: dashboard-core.dashboards.read.scope.any
      label: "Dashboard Dashboards Read Scope = Any"
      description: "Read all dashboards regardless of ownership (respects visibility and shares)."
      default_enabled: false
    - key: dashboard-core.dashboards.read.scope.own
      label: "Dashboard Dashboards Read Scope = Own"
      description: "Read only dashboards you own."
      default_enabled: false

    - key: dashboard-core.dashboards.write.scope.none
      label: "Dashboard Dashboards Write Scope = None"
      description: "Deny all dashboard write access."
      default_enabled: false
    - key: dashboard-core.dashboards.write.scope.any
      label: "Dashboard Dashboards Write Scope = Any"
      description: "Edit all dashboards regardless of ownership (respects shares)."
      default_enabled: false
    - key: dashboard-core.dashboards.write.scope.own
      label: "Dashboard Dashboards Write Scope = Own"
      description: "Edit only dashboards you own."
      default_enabled: false

    - key: dashboard-core.dashboards.create
      label: Create Dashboard
      description: "Create a new dashboard definition."
      default_enabled: false
